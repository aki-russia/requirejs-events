var Mangra;Mangra=new function(){var a,b,c;return c=batch(),a=function(a){return this.name=a,this._handlers=[],this._last_params=null,this},a.prototype={_handlers_caller:function(a){var b,d;return a=(a||this._handlers).concat([]),d={name:this.name},b="[object Array]"===toString.call(this._last_params)?this._last_params:[this._last_params],b.push(d),c.use(a).each(function(a){return a.apply(a.context,b)})},on:function(a,b,c){return a.context=b||a.context,a.options=c||a.options,a.id=ui_guid_generator(),this._handlers.push(a),null!=c&&null!=c.recall&&null!=this._last_params&&this._handlers_caller([a]),this},off:function(a){var b,c,d,e,f;for(f=this._handlers,b=d=0,e=f.length;e>d;b=++d)if(c=f[b],c.id===a.id)return this._handlers.splice(b,1),this},fire:function(a){return this._last_params=a,this._handlers_caller()}},b=function(a){return this.name=a,this.list={},this},b.prototype={list:{},init:function(a){var b;return b=this.sprout(),a.fire=function(){return b.fire.apply(bus,arguments)},a.once=function(){return b.once.apply(bus,arguments)},a.on=function(){return b.on.apply(bus,arguments)},a.off=function(){return b.off.apply(bus,arguments)}},sprout:function(a){var c;return c=this[a]||new b(a),null!=a&&(this[a]=c),c},create:function(b){return b?null!=this.list[b]?this.list[b]:this.list[b]=new a(b):new a},once:function(a,b,c,d){var e,f;return e=this,f=function(){return b.apply(this,arguments),e.off(f)},this.create(a).on(f,c,d),function(){return e.off(a,f)}},on:function(a,b,c,d){var e,f,g,h,i=this;for(f=a.split(/\s*,\s*/),g=0,h=f.length;h>g;g++)e=f[g],this.create(e).on(b,c,d);return function(){return i.off(a,b)}},off:function(a,b){var c=this;return this.list[a]&&this.list[a].off(b),function(){return c.on(a,b)}},fire:function(a,b){return this.create(a).fire(b)}},new b};